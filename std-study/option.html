<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-02-06 Sat 22:39 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Option</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Typas Liao" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">Option</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgeaaabcc">1. Use</a></li>
<li><a href="#orgffb12ed">2. Definition</a></li>
<li><a href="#orgb85bc1e">3. Associated Functions</a></li>
<li><a href="#org97bbbcf">4. Const Methods</a>
<ul>
<li><a href="#org421a2ea">4.1. Stable, but unstable const, issue 67441</a>
<ul>
<li><a href="#orgbbe57b2">4.1.1. <code>is_some</code></a></li>
<li><a href="#orga09e2a1">4.1.2. <code>is_none</code></a></li>
<li><a href="#org555dd92">4.1.3. <code>unwrap</code></a></li>
<li><a href="#org3966d32">4.1.4. <code>iter</code></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org8c7a010">5. Safe Methods</a>
<ul>
<li><a href="#orgef34b5e">5.1. Stable</a>
<ul>
<li><a href="#org8320eac">5.1.1. <code>as_ref</code></a></li>
<li><a href="#org7c9349b">5.1.2. <code>as_mut</code></a></li>
<li><a href="#orgdd87689">5.1.3. <code>as_pin_ref</code></a></li>
<li><a href="#org8b9601b">5.1.4. <code>as_pin_mut</code></a></li>
<li><a href="#org04ff6e9">5.1.5. <code>expect</code></a></li>
<li><a href="#org713b2a4">5.1.6. <code>expect_failed</code></a></li>
<li><a href="#org668a6e8">5.1.7. <code>unwrap_or</code></a></li>
<li><a href="#org53d8ef9">5.1.8. <code>unwrap_or_else</code></a></li>
<li><a href="#orge63a5a5">5.1.9. <code>map</code></a></li>
<li><a href="#org1674dd9">5.1.10. <code>map_or</code></a></li>
<li><a href="#orge961ad0">5.1.11. <code>map_or_else</code></a></li>
<li><a href="#org42600f3">5.1.12. <code>ok_or</code></a></li>
<li><a href="#orgce8d9aa">5.1.13. <code>ok_or_else</code></a></li>
<li><a href="#org34e83b2">5.1.14. <code>iter_mut</code></a></li>
<li><a href="#org670b177">5.1.15. <code>and</code></a></li>
<li><a href="#orgb19329a">5.1.16. <code>and_then</code></a></li>
<li><a href="#orgfeff8a6">5.1.17. <code>filter</code></a></li>
<li><a href="#org8d37afd">5.1.18. <code>or</code></a></li>
<li><a href="#org0bd03c2">5.1.19. <code>or_else</code></a></li>
<li><a href="#orgda8d884">5.1.20. <code>xor</code></a></li>
<li><a href="#org81183c7">5.1.21. <code>get_or_insert</code></a></li>
<li><a href="#org90267c5">5.1.22. <code>get_or_insert_with</code></a></li>
<li><a href="#orgfef0707">5.1.23. <code>take</code></a></li>
<li><a href="#org0726510">5.1.24. <code>replace</code></a></li>
<li><a href="#org172ddc7">5.1.25. <code>zip</code></a></li>
<li><a href="#orgbe99ee9">5.1.26. <code>copied</code></a></li>
<li><a href="#orgae9f33a">5.1.27. <code>cloned</code></a></li>
<li><a href="#orgce30917">5.1.28. <code>unwrap_or_default</code></a></li>
<li><a href="#org07fc28d">5.1.29. <code>as_deref</code></a></li>
<li><a href="#org8cdea00">5.1.30. <code>as_deref_mut</code></a></li>
<li><a href="#org5a35880">5.1.31. <code>transpose</code></a></li>
</ul>
</li>
<li><a href="#orgf88c010">5.2. Unstable</a>
<ul>
<li><a href="#org51caef4">5.2.1. <code>contains</code></a></li>
<li><a href="#org18edcb8">5.2.2. <code>zip_with</code></a></li>
<li><a href="#orgf610c7b">5.2.3. <code>expect_none</code></a></li>
<li><a href="#org3d65de6">5.2.4. <code>expect_none_failed</code></a></li>
<li><a href="#org7eb159f">5.2.5. <code>unwrap_none</code></a></li>
<li><a href="#orge3be1b1">5.2.6. <code>flatten</code></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org817b47e">6. Unsafe Methods</a></li>
<li><a href="#orge20dbee">7. Trait Implementations</a>
<ul>
<li><a href="#org19ad260">7.1. Clone</a></li>
<li><a href="#org32d0bd7">7.2. Default</a></li>
<li><a href="#orga4dfbe0">7.3. IntoIterator</a></li>
<li><a href="#org33a4279">7.4. From</a></li>
<li><a href="#org2f99732">7.5. FromIterator</a></li>
<li><a href="#orgfef48a0">7.6. ops::Try (Unstable)</a></li>
</ul>
</li>
<li><a href="#org66ca0c0">8. Structs</a>
<ul>
<li><a href="#orga9253f5">8.1. Item</a>
<ul>
<li><a href="#org4ee1135">8.1.1. Definition</a></li>
<li><a href="#org503cc93">8.1.2. Trait Implementations</a></li>
</ul>
</li>
<li><a href="#org4f784b8">8.2. Iter</a>
<ul>
<li><a href="#orga3462c9">8.2.1. Definition</a></li>
<li><a href="#org797c545">8.2.2. Trait Implementations</a></li>
</ul>
</li>
<li><a href="#orgbfe7556">8.3. IterMut</a>
<ul>
<li><a href="#org9b2ca75">8.3.1. Definition</a></li>
<li><a href="#orgbe345aa">8.3.2. Trait Implementations</a></li>
</ul>
</li>
<li><a href="#org720c460">8.4. IntoIter</a>
<ul>
<li><a href="#org514c890">8.4.1. Definition</a></li>
<li><a href="#org41c01d1">8.4.2. Trait Implementations</a></li>
</ul>
</li>
<li><a href="#org3bda798">8.5. NoneError (Unstable)</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
<a href="https://github.com/rust-lang/rust/blob/master/library/core/src/option.rs">Source Code Location</a>
</p>

<div id="outline-container-orgeaaabcc" class="outline-2">
<h2 id="orgeaaabcc"><span class="section-number-2">1</span> <a id="org5cf213c"></a> Use</h2>
<div class="outline-text-2" id="text-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">use</span> <span style="color: #6699cc;">core</span>::<span style="color: #6699cc;">iter</span>::<span style="color: #cccccc;">{</span><span style="color: #6699cc;">FromIterator</span>, <span style="color: #6699cc;">FusedIterator</span>, <span style="color: #6699cc;">TrustedLen</span><span style="color: #cccccc;">}</span>;
<span style="color: #99cc99;">use</span> <span style="color: #6699cc;">core</span>::<span style="color: #6699cc;">pin</span>::<span style="color: #6699cc;">Pin</span>;
<span style="color: #99cc99;">use</span> <span style="color: #6699cc;">core</span>::<span style="color: #cccccc;">{</span>
    convert, fmt, hint, mem,
    <span style="color: #6699cc;">ops</span>::<span style="color: #66cccc;">{</span><span style="color: #99cc99;">self</span>, <span style="color: #6699cc;">Deref</span>, <span style="color: #6699cc;">DerefMut</span><span style="color: #66cccc;">}</span>,
<span style="color: #cccccc;">}</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgffb12ed" class="outline-2">
<h2 id="orgffb12ed"><span class="section-number-2">2</span> Definition</h2>
<div class="outline-text-2" id="text-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">derive</span><span style="color: #66cccc;">(</span><span style="color: #cc99cc;">Copy, PartialEq, PartialOrd, Eq, Ord, Debug, Hash</span><span style="color: #66cccc;">)</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">enum</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #cc99cc;">/// No value</span>
    <span style="color: #6699cc;">None</span>,
    <span style="color: #cc99cc;">/// Some value `T`</span>
    <span style="color: #6699cc;">Some</span><span style="color: #66cccc;">(</span><span style="color: #6699cc;">T</span><span style="color: #66cccc;">)</span>,
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
在去除一些給編譯器看的屬性巨集後，是非常簡單的定義。
</p>
</div>
</div>

<div id="outline-container-orgb85bc1e" class="outline-2">
<h2 id="orgb85bc1e"><span class="section-number-2">3</span> Associated Functions</h2>
</div>

<div id="outline-container-org97bbbcf" class="outline-2">
<h2 id="org97bbbcf"><span class="section-number-2">4</span> Const Methods</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org421a2ea" class="outline-3">
<h3 id="org421a2ea"><span class="section-number-3">4.1</span> Stable, but unstable const, issue 67441</h3>
<div class="outline-text-3" id="text-4-1">
</div>
<div id="outline-container-orgbbe57b2" class="outline-4">
<h4 id="orgbbe57b2"><span class="section-number-4">4.1.1</span> <a id="org9065cb6"></a> <code>is_some</code></h4>
<div class="outline-text-4" id="text-4-1-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">const</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">is_some</span><span style="color: #cccccc;">(</span>&amp;<span style="color: #99cc99;">self</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">bool</span> <span style="color: #cccccc;">{</span>
    <span style="color: #cc99cc;">matches!</span><span style="color: #66cccc;">(</span>*<span style="color: #99cc99;">self</span>, <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>_<span style="color: #ffcc66;">)</span><span style="color: #66cccc;">)</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
用到了 <a href="https://doc.rust-lang.org/std/macro.matches.html">matches</a> 巨集，在對應到任何有值的東西時回傳 <code>true</code> ，反之則回傳 <code>false</code> 。
</p>
</div>
</div>

<div id="outline-container-orga09e2a1" class="outline-4">
<h4 id="orga09e2a1"><span class="section-number-4">4.1.2</span> <a id="org4ac18bb"></a> <code>is_none</code></h4>
<div class="outline-text-4" id="text-4-1-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">const</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">is_none</span><span style="color: #cccccc;">(</span>&amp;<span style="color: #99cc99;">self</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">bool</span> <span style="color: #cccccc;">{</span>
    !<span style="color: #99cc99;">self</span>.is_some<span style="color: #66cccc;">()</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
上面的 <code>is_some</code> 的反轉，只是我不太能理解為什麼是用 <code>Some</code> 而不是 <code>None</code> 去對應。
</p>
</div>
</div>

<div id="outline-container-org555dd92" class="outline-4">
<h4 id="org555dd92"><span class="section-number-4">4.1.3</span> <a id="org51b052c"></a> <code>unwrap</code></h4>
<div class="outline-text-4" id="text-4-1-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">track_caller</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">const</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">unwrap</span><span style="color: #cccccc;">(</span><span style="color: #99cc99;">self</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">T</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">match</span> <span style="color: #99cc99;">self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>val<span style="color: #ffcc66;">)</span> =&gt; val,
        <span style="color: #6699cc;">None</span> =&gt; <span style="color: #cc99cc;">panic!</span><span style="color: #ffcc66;">(</span><span style="color: #66cccc;">"called `Option::unwrap()` on a `None` value"</span><span style="color: #ffcc66;">)</span>,
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
就是一個在 <code>None</code> 會噴死你的函數，會拿走所有權。
</p>
</div>
</div>

<div id="outline-container-org3966d32" class="outline-4">
<h4 id="org3966d32"><span class="section-number-4">4.1.4</span> <a id="org018c460"></a> <code>iter</code></h4>
<div class="outline-text-4" id="text-4-1-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">const</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">iter</span><span style="color: #cccccc;">(</span>&amp;<span style="color: #99cc99;">self</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">Iter</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">_</span>, <span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #6699cc;">Iter</span> <span style="color: #66cccc;">{</span> <span style="color: #ffcc66;">inner</span>: <span style="color: #6699cc;">Item</span> <span style="color: #ffcc66;">{</span> <span style="color: #ffcc66;">opt</span>: <span style="color: #99cc99;">self</span>.as_ref<span style="color: #cccccc;">()</span> <span style="color: #ffcc66;">}</span> <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
回傳的型態 <a href="#orgcb4dceb">Iter</a> 是模組內定義的一個結構。
</p>
</div>
</div>
</div>
</div>



<div id="outline-container-org8c7a010" class="outline-2">
<h2 id="org8c7a010"><span class="section-number-2">5</span> Safe Methods</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-orgef34b5e" class="outline-3">
<h3 id="orgef34b5e"><span class="section-number-3">5.1</span> Stable</h3>
<div class="outline-text-3" id="text-5-1">
</div>
<div id="outline-container-org8320eac" class="outline-4">
<h4 id="org8320eac"><span class="section-number-4">5.1.1</span> <a id="orgc447352"></a> <code>as_ref</code></h4>
<div class="outline-text-4" id="text-5-1-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">const</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">as_ref</span><span style="color: #cccccc;">(</span>&amp;<span style="color: #99cc99;">self</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span>&amp;<span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">match</span> *<span style="color: #99cc99;">self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span><span style="color: #99cc99;">ref</span> <span style="color: #ffcc66;">x</span><span style="color: #ffcc66;">)</span> =&gt; <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>x<span style="color: #ffcc66;">)</span>,
        <span style="color: #6699cc;">None</span> =&gt; <span style="color: #6699cc;">None</span>,
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
用到了 <code>match</code> 裡的 <code>ref</code> 關鍵字，配對的值本身型態是 <code>U</code> 時，加上 <code>ref</code> 則在分支內的變數 <code>x</code> 會是 <code>&amp;U</code> 型態。
</p>
</div>
</div>

<div id="outline-container-org7c9349b" class="outline-4">
<h4 id="org7c9349b"><span class="section-number-4">5.1.2</span> <a id="orgde469bf"></a> <code>as_mut</code></h4>
<div class="outline-text-4" id="text-5-1-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">as_mut</span><span style="color: #cccccc;">(</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #99cc99;">self</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">match</span> *<span style="color: #99cc99;">self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span><span style="color: #99cc99;">ref</span> <span style="color: #99cc99;">mut</span> <span style="color: #ffcc66;">x</span><span style="color: #ffcc66;">)</span> =&gt; <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>x<span style="color: #ffcc66;">)</span>,
        <span style="color: #6699cc;">None</span> =&gt; <span style="color: #6699cc;">None</span>,
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
同上，多用了一個 <code>mut</code> 關鍵字，型態改變成 <code>&amp;mut U</code> 。
</p>
</div>
</div>

<div id="outline-container-orgdd87689" class="outline-4">
<h4 id="orgdd87689"><span class="section-number-4">5.1.3</span> <a id="org04371e6"></a> <code>as_pin_ref</code></h4>
<div class="outline-text-4" id="text-5-1-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">as_pin_ref</span><span style="color: #cccccc;">(</span><span style="color: #99cc99;">self</span>: <span style="color: #6699cc;">Pin</span><span style="color: #66cccc;">&lt;</span>&amp;<span style="color: #6699cc;">Self</span><span style="color: #66cccc;">&gt;</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">Pin</span><span style="color: #66cccc;">&lt;</span>&amp;<span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">SAFETY: `x` is guaranteed to be pinned because it comes from `self`</span>
    <span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">which is pinned.</span>
    <span style="color: #f2777a; font-weight: bold;">unsafe</span> <span style="color: #66cccc;">{</span> <span style="color: #6699cc;">Pin</span>::get_ref<span style="color: #ffcc66;">(</span><span style="color: #99cc99;">self</span><span style="color: #ffcc66;">)</span>.as_ref<span style="color: #ffcc66;">()</span>.map<span style="color: #ffcc66;">(</span>|x| <span style="color: #6699cc;">Pin</span>::new_unchecked<span style="color: #cccccc;">(</span>x<span style="color: #cccccc;">)</span><span style="color: #ffcc66;">)</span> <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
<a href="#org5cf213c">use</a>
TODO: usage of <code>core::pin::Pin</code>
</p>
</div>
</div>

<div id="outline-container-org8b9601b" class="outline-4">
<h4 id="org8b9601b"><span class="section-number-4">5.1.4</span> <a id="org7edadb7"></a> <code>as_pin_mut</code></h4>
<div class="outline-text-4" id="text-5-1-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">as_pin_mut</span><span style="color: #cccccc;">(</span><span style="color: #99cc99;">self</span>: <span style="color: #6699cc;">Pin</span><span style="color: #66cccc;">&lt;</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #6699cc;">Self</span><span style="color: #66cccc;">&gt;</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">Pin</span><span style="color: #66cccc;">&lt;</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">SAFETY: `get_unchecked_mut` is never used to move the `Option` inside `self`.</span>
    <span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">`x` is guaranteed to be pinned because it comes from `self` which is pinned.</span>
    <span style="color: #f2777a; font-weight: bold;">unsafe</span> <span style="color: #66cccc;">{</span> <span style="color: #6699cc;">Pin</span>::get_unchecked_mut<span style="color: #ffcc66;">(</span><span style="color: #99cc99;">self</span><span style="color: #ffcc66;">)</span>.as_mut<span style="color: #ffcc66;">()</span>.map<span style="color: #ffcc66;">(</span>|x| <span style="color: #6699cc;">Pin</span>::new_unchecked<span style="color: #cccccc;">(</span>x<span style="color: #cccccc;">)</span><span style="color: #ffcc66;">)</span> <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
<a href="#org5cf213c">use</a>
TODO: usage of <code>core::pin::Pin</code>
</p>
</div>
</div>

<div id="outline-container-org04ff6e9" class="outline-4">
<h4 id="org04ff6e9"><span class="section-number-4">5.1.5</span> <a id="org7ea0816"></a> <code>expect</code></h4>
<div class="outline-text-4" id="text-5-1-5">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">track_caller</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">expect</span><span style="color: #cccccc;">(</span><span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">msg</span>: &amp;<span style="color: #6699cc;">str</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">T</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">match</span> <span style="color: #99cc99;">self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>val<span style="color: #ffcc66;">)</span> =&gt; val,
        <span style="color: #6699cc;">None</span> =&gt; expect_failed<span style="color: #ffcc66;">(</span>msg<span style="color: #ffcc66;">)</span>,
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
裡面的 <code>expect_failed()</code> 是私有方法，在對應到 <code>None</code> 時會觸發。會拿走所有權。
</p>
</div>
</div>

<div id="outline-container-org713b2a4" class="outline-4">
<h4 id="org713b2a4"><span class="section-number-4">5.1.6</span> <code>expect_failed</code></h4>
<div class="outline-text-4" id="text-5-1-6">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">(</span><span style="color: #cc99cc;">never</span><span style="color: #66cccc;">)</span><span style="color: #cccccc;">]</span>
<span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">cold</span><span style="color: #cccccc;">]</span>
<span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">track_caller</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">fn</span> <span style="color: #f99157;">expect_failed</span><span style="color: #cccccc;">(</span><span style="color: #ffcc66;">msg</span>: &amp;<span style="color: #6699cc;">str</span><span style="color: #cccccc;">)</span> -&gt; ! <span style="color: #cccccc;">{</span>
    <span style="color: #cc99cc;">panic!</span><span style="color: #66cccc;">(</span><span style="color: #66cccc;">"{}"</span>, msg<span style="color: #66cccc;">)</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
屬性巨集 <code>cold</code> 是對編譯器提示這個函數不太可能被呼叫到。問題：為何會需要獨立成一個方法？
</p>
</div>
</div>

<div id="outline-container-org668a6e8" class="outline-4">
<h4 id="org668a6e8"><span class="section-number-4">5.1.7</span> <a id="org274a39b"></a> <code>unwrap_or</code></h4>
<div class="outline-text-4" id="text-5-1-7">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">unwrap_or</span><span style="color: #cccccc;">(</span><span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">default</span>: <span style="color: #6699cc;">T</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">T</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">match</span> <span style="color: #99cc99;">self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>x<span style="color: #ffcc66;">)</span> =&gt; x,
        <span style="color: #6699cc;">None</span> =&gt; default,
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
請注意這裡會拿走自身與 <code>default</code> 的所有權。
</p>
</div>
</div>

<div id="outline-container-org53d8ef9" class="outline-4">
<h4 id="org53d8ef9"><span class="section-number-4">5.1.8</span> <a id="orgb7b1f23"></a> <code>unwrap_or_else</code></h4>
<div class="outline-text-4" id="text-5-1-8">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">unwrap_or_else</span><span style="color: #cccccc;">&lt;</span><span style="color: #ffcc66;">F</span>: <span style="color: #6699cc;">FnOnce</span><span style="color: #66cccc;">()</span> -&gt; <span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;(</span><span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">f</span>: <span style="color: #6699cc;">F</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">T</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">match</span> <span style="color: #99cc99;">self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>x<span style="color: #ffcc66;">)</span> =&gt; x,
        <span style="color: #6699cc;">None</span> =&gt; f<span style="color: #ffcc66;">()</span>,
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
裡面的函數 <code>f</code> 會拿走所有內部變數的所有權，自身的所有權也會被此方法拿走。
</p>
</div>
</div>

<div id="outline-container-orge63a5a5" class="outline-4">
<h4 id="orge63a5a5"><span class="section-number-4">5.1.9</span> <a id="org406432d"></a> <code>map</code></h4>
<div class="outline-text-4" id="text-5-1-9">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">stable</span><span style="color: #66cccc;">(</span><span style="color: #cc99cc;">feature = </span><span style="color: #66cccc;">"rust1"</span><span style="color: #cc99cc;">, since = </span><span style="color: #66cccc;">"1.0.0"</span><span style="color: #66cccc;">)</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">map</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">U</span>, <span style="color: #ffcc66;">F</span>: <span style="color: #6699cc;">FnOnce</span><span style="color: #66cccc;">(</span><span style="color: #6699cc;">T</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">U</span><span style="color: #cccccc;">&gt;(</span><span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">f</span>: <span style="color: #6699cc;">F</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">U</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">match</span> <span style="color: #99cc99;">self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>x<span style="color: #ffcc66;">)</span> =&gt; <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>f<span style="color: #cccccc;">(</span>x<span style="color: #cccccc;">)</span><span style="color: #ffcc66;">)</span>,
        <span style="color: #6699cc;">None</span> =&gt; <span style="color: #6699cc;">None</span>,
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
利用 <code>f</code> 將自身映射到 <code>f(x)</code> 上，此方法會拿走自身的所有權。
</p>
</div>
</div>

<div id="outline-container-org1674dd9" class="outline-4">
<h4 id="org1674dd9"><span class="section-number-4">5.1.10</span> <a id="orgf23d450"></a> <code>map_or</code></h4>
<div class="outline-text-4" id="text-5-1-10">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">map_or</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">U</span>, <span style="color: #ffcc66;">F</span>: <span style="color: #6699cc;">FnOnce</span><span style="color: #66cccc;">(</span><span style="color: #6699cc;">T</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">U</span><span style="color: #cccccc;">&gt;(</span><span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">default</span>: <span style="color: #6699cc;">U</span>, <span style="color: #ffcc66;">f</span>: <span style="color: #6699cc;">F</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">U</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">match</span> <span style="color: #99cc99;">self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>t<span style="color: #ffcc66;">)</span> =&gt; f<span style="color: #ffcc66;">(</span>t<span style="color: #ffcc66;">)</span>,
        <span style="color: #6699cc;">None</span> =&gt; default,
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
與 <a href="#org274a39b">unwrap<sub>or</sub></a> 相似，但 <code>default</code> 的型態為映射後的 <code>U</code> 而非原來的 <code>T</code> 。
</p>
</div>
</div>

<div id="outline-container-orge961ad0" class="outline-4">
<h4 id="orge961ad0"><span class="section-number-4">5.1.11</span> <a id="org83ade9b"></a> <code>map_or_else</code></h4>
<div class="outline-text-4" id="text-5-1-11">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">map_or_else</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">U</span>, <span style="color: #ffcc66;">D</span>: <span style="color: #6699cc;">FnOnce</span><span style="color: #66cccc;">()</span> -&gt; <span style="color: #6699cc;">U</span>, <span style="color: #ffcc66;">F</span>: <span style="color: #6699cc;">FnOnce</span><span style="color: #66cccc;">(</span><span style="color: #6699cc;">T</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">U</span><span style="color: #cccccc;">&gt;(</span><span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">default</span>: <span style="color: #6699cc;">D</span>, <span style="color: #ffcc66;">f</span>: <span style="color: #6699cc;">F</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">U</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">match</span> <span style="color: #99cc99;">self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>t<span style="color: #ffcc66;">)</span> =&gt; f<span style="color: #ffcc66;">(</span>t<span style="color: #ffcc66;">)</span>,
        <span style="color: #6699cc;">None</span> =&gt; default<span style="color: #ffcc66;">()</span>,
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
與 <a href="#orgb7b1f23">unwrap<sub>or</sub><sub>else</sub></a> 相似，但型態為映射後的 <code>U</code> 。
</p>
</div>
</div>

<div id="outline-container-org42600f3" class="outline-4">
<h4 id="org42600f3"><span class="section-number-4">5.1.12</span> <a id="orgf522a5b"></a> <code>ok_or</code></h4>
<div class="outline-text-4" id="text-5-1-12">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">ok_or</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">E</span><span style="color: #cccccc;">&gt;(</span><span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">err</span>: <span style="color: #6699cc;">E</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">Result</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span>, <span style="color: #6699cc;">E</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">match</span> <span style="color: #99cc99;">self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>v<span style="color: #ffcc66;">)</span> =&gt; <span style="color: #6699cc;">Ok</span><span style="color: #ffcc66;">(</span>v<span style="color: #ffcc66;">)</span>,
        <span style="color: #6699cc;">None</span> =&gt; <span style="color: #6699cc;">Err</span><span style="color: #ffcc66;">(</span>err<span style="color: #ffcc66;">)</span>,
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
把 <code>Option&lt;T&gt;</code> 型態轉成 <code>Result&lt;T, E&gt;</code> 型態的神方法，需要自行加上錯誤型態，兩個參數都會被拿走所有權。
</p>
</div>
</div>

<div id="outline-container-orgce8d9aa" class="outline-4">
<h4 id="orgce8d9aa"><span class="section-number-4">5.1.13</span> <a id="orga320374"></a> <code>ok_or_else</code></h4>
<div class="outline-text-4" id="text-5-1-13">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">ok_or_else</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">E</span>, <span style="color: #ffcc66;">F</span>: <span style="color: #6699cc;">FnOnce</span><span style="color: #66cccc;">()</span> -&gt; <span style="color: #6699cc;">E</span><span style="color: #cccccc;">&gt;(</span><span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">err</span>: <span style="color: #6699cc;">F</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">Result</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span>, <span style="color: #6699cc;">E</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">match</span> <span style="color: #99cc99;">self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>v<span style="color: #ffcc66;">)</span> =&gt; <span style="color: #6699cc;">Ok</span><span style="color: #ffcc66;">(</span>v<span style="color: #ffcc66;">)</span>,
        <span style="color: #6699cc;">None</span> =&gt; <span style="color: #6699cc;">Err</span><span style="color: #ffcc66;">(</span>err<span style="color: #cccccc;">()</span><span style="color: #ffcc66;">)</span>,
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
從 <code>ok_or</code> 的錯誤參數改成使用一個回傳錯誤的函數。會拿走自身的所有權。
</p>
</div>
</div>

<div id="outline-container-org34e83b2" class="outline-4">
<h4 id="org34e83b2"><span class="section-number-4">5.1.14</span> <a id="org7e13977"></a> <code>iter_mut</code></h4>
<div class="outline-text-4" id="text-5-1-14">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">iter_mut</span><span style="color: #cccccc;">(</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #99cc99;">self</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">IterMut</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">_</span>, <span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #6699cc;">IterMut</span> <span style="color: #66cccc;">{</span> <span style="color: #ffcc66;">inner</span>: <span style="color: #6699cc;">Item</span> <span style="color: #ffcc66;">{</span> <span style="color: #ffcc66;">opt</span>: <span style="color: #99cc99;">self</span>.as_mut<span style="color: #cccccc;">()</span> <span style="color: #ffcc66;">}</span> <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
利用新結構 <a href="#org662dc35">IterMut</a> 來達成特徵實作的隔離。
</p>
</div>
</div>

<div id="outline-container-org670b177" class="outline-4">
<h4 id="org670b177"><span class="section-number-4">5.1.15</span> <a id="orgb45e837"></a> <code>and</code></h4>
<div class="outline-text-4" id="text-5-1-15">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">and</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">U</span><span style="color: #cccccc;">&gt;(</span><span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">optb</span>: <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">U</span><span style="color: #66cccc;">&gt;</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">U</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">match</span> <span style="color: #99cc99;">self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>_<span style="color: #ffcc66;">)</span> =&gt; optb,
        <span style="color: #6699cc;">None</span> =&gt; <span style="color: #6699cc;">None</span>,
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
與不同型態做邏輯的「且」運算，注意是回傳 <code>optb</code> 的結果，兩方的所有權都會被轉移。
</p>
</div>
</div>

<div id="outline-container-orgb19329a" class="outline-4">
<h4 id="orgb19329a"><span class="section-number-4">5.1.16</span> <a id="orgccc077b"></a> <code>and_then</code></h4>
<div class="outline-text-4" id="text-5-1-16">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">stable</span><span style="color: #66cccc;">(</span><span style="color: #cc99cc;">feature = </span><span style="color: #66cccc;">"rust1"</span><span style="color: #cc99cc;">, since = </span><span style="color: #66cccc;">"1.0.0"</span><span style="color: #66cccc;">)</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">and_then</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">U</span>, <span style="color: #ffcc66;">F</span>: <span style="color: #6699cc;">FnOnce</span><span style="color: #66cccc;">(</span><span style="color: #6699cc;">T</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">U</span><span style="color: #66cccc;">&gt;</span><span style="color: #cccccc;">&gt;(</span><span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">f</span>: <span style="color: #6699cc;">F</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">U</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">match</span> <span style="color: #99cc99;">self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>x<span style="color: #ffcc66;">)</span> =&gt; f<span style="color: #ffcc66;">(</span>x<span style="color: #ffcc66;">)</span>,
        <span style="color: #6699cc;">None</span> =&gt; <span style="color: #6699cc;">None</span>,
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
上方邏輯「且」運算中，將參數 <code>optb</code> 改為函數 <code>f</code> 的方法。非常類似於 <a href="#org406432d">map()</a> ，但是在函數的定義上不同。 <code>map()</code> 使用的函數為回傳型態 <code>U</code> 的一次性函數，而 <code>and_then()</code> 則是使用回傳型態為 <code>Option&lt;U&gt;</code> 的一次性函數。
</p>
</div>
</div>

<div id="outline-container-orgfeff8a6" class="outline-4">
<h4 id="orgfeff8a6"><span class="section-number-4">5.1.17</span> <a id="orgbd5e33d"></a> <code>filter</code></h4>
<div class="outline-text-4" id="text-5-1-17">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">filter</span><span style="color: #cccccc;">&lt;</span><span style="color: #ffcc66;">P</span>: <span style="color: #6699cc;">FnOnce</span><span style="color: #66cccc;">(</span>&amp;<span style="color: #6699cc;">T</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">bool</span><span style="color: #cccccc;">&gt;(</span><span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">predicate</span>: <span style="color: #6699cc;">P</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">Self</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">if</span> <span style="color: #99cc99;">let</span> <span style="color: #6699cc;">Some</span><span style="color: #66cccc;">(</span>x<span style="color: #66cccc;">)</span> = <span style="color: #99cc99;">self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">if</span> predicate<span style="color: #ffcc66;">(</span>&amp;x<span style="color: #ffcc66;">)</span> <span style="color: #ffcc66;">{</span>
            <span style="color: #99cc99;">return</span> <span style="color: #6699cc;">Some</span><span style="color: #cccccc;">(</span>x<span style="color: #cccccc;">)</span>;
        <span style="color: #ffcc66;">}</span>
    <span style="color: #66cccc;">}</span>
    <span style="color: #6699cc;">None</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
<code>P</code> 為接受一個參數為 <code>&amp;T</code> 的一次性函數，為何不用一般的 <code>Fn</code> ？這段程式碼是用 <code>if let</code> 而不是用 <code>match</code> ，不確定這樣寫的原因為何，或許與 <code>match</code> 對 <code>predicate(&amp;x)</code> 的解析有關係。
</p>

<p>
我不確定這樣會不會爆炸的寫法：
</p>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">match</span> <span style="color: #99cc99;">self</span> <span style="color: #cccccc;">{</span>
    <span style="color: #6699cc;">Some</span><span style="color: #66cccc;">(</span>x<span style="color: #66cccc;">)</span> =&gt; <span style="color: #99cc99;">match</span> predicate<span style="color: #66cccc;">(</span>&amp;x<span style="color: #66cccc;">)</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">true</span> =&gt; <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>x<span style="color: #ffcc66;">)</span>,
        <span style="color: #99cc99;">false</span> =&gt; <span style="color: #6699cc;">None</span>,
    <span style="color: #66cccc;">}</span>,
    <span style="color: #6699cc;">None</span>,
<span style="color: #cccccc;">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8d37afd" class="outline-4">
<h4 id="org8d37afd"><span class="section-number-4">5.1.18</span> <a id="orga979f94"></a> <code>or</code></h4>
<div class="outline-text-4" id="text-5-1-18">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">or</span><span style="color: #cccccc;">(</span><span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">optb</span>: <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">match</span> <span style="color: #99cc99;">self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>_<span style="color: #ffcc66;">)</span> =&gt; <span style="color: #99cc99;">self</span>,
        <span style="color: #6699cc;">None</span> =&gt; optb,
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
與同型態做邏輯的「或」運算，兩個參數都會被拿走所有權。在自身有值時會回傳自身，反之回傳 <code>optb</code> 。
</p>
</div>
</div>

<div id="outline-container-org0bd03c2" class="outline-4">
<h4 id="org0bd03c2"><span class="section-number-4">5.1.19</span> <a id="org931a078"></a> <code>or_else</code></h4>
<div class="outline-text-4" id="text-5-1-19">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">or_else</span><span style="color: #cccccc;">&lt;</span><span style="color: #ffcc66;">F</span>: <span style="color: #6699cc;">FnOnce</span><span style="color: #66cccc;">()</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span><span style="color: #cccccc;">&gt;(</span><span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">f</span>: <span style="color: #6699cc;">F</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">match</span> <span style="color: #99cc99;">self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>_<span style="color: #ffcc66;">)</span> =&gt; <span style="color: #99cc99;">self</span>,
        <span style="color: #6699cc;">None</span> =&gt; f<span style="color: #ffcc66;">()</span>,
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
上方邏輯「或」運算中，把 <code>optb</code> 以 <code>f</code> 這個函數取代掉的方法。注意「且」能回傳不同型態，而「或」只能回傳同一型態。
</p>
</div>
</div>

<div id="outline-container-orgda8d884" class="outline-4">
<h4 id="orgda8d884"><span class="section-number-4">5.1.20</span> <a id="org6ca3ac5"></a> <code>xor</code></h4>
<div class="outline-text-4" id="text-5-1-20">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">xor</span><span style="color: #cccccc;">(</span><span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">optb</span>: <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">match</span> <span style="color: #66cccc;">(</span><span style="color: #99cc99;">self</span>, optb<span style="color: #66cccc;">)</span> <span style="color: #66cccc;">{</span>
        <span style="color: #ffcc66;">(</span><span style="color: #6699cc;">Some</span><span style="color: #cccccc;">(</span>a<span style="color: #cccccc;">)</span>, <span style="color: #6699cc;">None</span><span style="color: #ffcc66;">)</span> =&gt; <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>a<span style="color: #ffcc66;">)</span>,
        <span style="color: #ffcc66;">(</span><span style="color: #6699cc;">None</span>, <span style="color: #6699cc;">Some</span><span style="color: #cccccc;">(</span>b<span style="color: #cccccc;">)</span><span style="color: #ffcc66;">)</span> =&gt; <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>b<span style="color: #ffcc66;">)</span>,
        _ =&gt; <span style="color: #6699cc;">None</span>,
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
與同型態做邏輯的「互斥或」運算，兩個參數都會被拿走所有權。兩者皆有或皆無值時回傳 <code>None</code> ，其一有值時回傳有值的一邊。
</p>
</div>
</div>

<div id="outline-container-org81183c7" class="outline-4">
<h4 id="org81183c7"><span class="section-number-4">5.1.21</span> <a id="org46e3b94"></a> <code>get_or_insert</code></h4>
<div class="outline-text-4" id="text-5-1-21">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">get_or_insert</span><span style="color: #cccccc;">(</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">v</span>: <span style="color: #6699cc;">T</span><span style="color: #cccccc;">)</span> -&gt; &amp;<span style="color: #99cc99;">mut</span> <span style="color: #6699cc;">T</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">self</span>.get_or_insert_with<span style="color: #66cccc;">(</span>|| v<span style="color: #66cccc;">)</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
以一個簡單的閉包直接把 <code>v</code> 轉移進去 <a href="#org52c33c2">get<sub>or</sub><sub>insert</sub><sub>with</sub>()</a> ，避免了重複的程式碼。
</p>
</div>
</div>

<div id="outline-container-org90267c5" class="outline-4">
<h4 id="org90267c5"><span class="section-number-4">5.1.22</span> <a id="org52c33c2"></a> <code>get_or_insert_with</code></h4>
<div class="outline-text-4" id="text-5-1-22">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">get_or_insert_with</span><span style="color: #cccccc;">&lt;</span><span style="color: #ffcc66;">F</span>: <span style="color: #6699cc;">FnOnce</span><span style="color: #66cccc;">()</span> -&gt; <span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;(</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">f</span>: <span style="color: #6699cc;">F</span><span style="color: #cccccc;">)</span> -&gt; &amp;<span style="color: #99cc99;">mut</span> <span style="color: #6699cc;">T</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">if</span> <span style="color: #99cc99;">let</span> <span style="color: #6699cc;">None</span> = *<span style="color: #99cc99;">self</span> <span style="color: #66cccc;">{</span>
        *<span style="color: #99cc99;">self</span> = <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>f<span style="color: #cccccc;">()</span><span style="color: #ffcc66;">)</span>;
    <span style="color: #66cccc;">}</span>

    <span style="color: #99cc99;">match</span> *<span style="color: #99cc99;">self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span><span style="color: #99cc99;">ref</span> <span style="color: #99cc99;">mut</span> <span style="color: #ffcc66;">v</span><span style="color: #ffcc66;">)</span> =&gt; v,
        <span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">SAFETY: a `None` variant for `self` would have been replaced by a `Some`</span>
        <span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">variant in the code above.</span>
        <span style="color: #6699cc;">None</span> =&gt; <span style="color: #f2777a; font-weight: bold;">unsafe</span> <span style="color: #ffcc66;">{</span> <span style="color: #6699cc;">hint</span>::unreachable_unchecked<span style="color: #cccccc;">()</span> <span style="color: #ffcc66;">}</span>,
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
第一段程式碼將所有的 <code>None</code> 轉換成 <code>Some(f())</code> 。第二段程式碼中利用 <code>match</code> 的 <code>ref mut</code> 把 <code>T</code> 轉成 <code>&amp;mut T</code> 後回傳，其中 <code>None</code> 分支由第一段保證不會被執行到，因此用一段 SAFETY 註解標示為何使用到 <code>unsafe</code> 。
此處有用到 <a href="#org5cf213c">core::hint</a> 。
</p>
</div>
</div>

<div id="outline-container-orgfef0707" class="outline-4">
<h4 id="orgfef0707"><span class="section-number-4">5.1.23</span> <a id="org363d475"></a> <code>take</code></h4>
<div class="outline-text-4" id="text-5-1-23">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">take</span><span style="color: #cccccc;">(</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #99cc99;">self</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #6699cc;">mem</span>::take<span style="color: #66cccc;">(</span><span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
此處用到 <a href="#org5cf213c">core::mem</a> 的 <a href="https://doc.rust-lang.org/core/mem/fn.take.html">take()</a> 。這個函數需要 <code>Option</code> 自身的 <a href="#orgcb45a95">Default</a> 特徵實作，會將內部型態為 <code>T</code> 的值以預設值取代，並回傳被取代的值。若這個型態沒有標註為 <code>Copy</code> 特徵，則回傳會拿走所有權。
</p>
</div>
</div>

<div id="outline-container-org0726510" class="outline-4">
<h4 id="org0726510"><span class="section-number-4">5.1.24</span> <a id="org1e7f303"></a> <code>replace</code></h4>
<div class="outline-text-4" id="text-5-1-24">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">replace</span><span style="color: #cccccc;">(</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">value</span>: <span style="color: #6699cc;">T</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #6699cc;">mem</span>::replace<span style="color: #66cccc;">(</span><span style="color: #99cc99;">self</span>, <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>value<span style="color: #ffcc66;">)</span><span style="color: #66cccc;">)</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
此處用到 <a href="#org5cf213c">core::mem</a> 的 <a href="https://doc.rust-lang.org/core/mem/fn.replace.html">replace()</a> 。這個函數會將內部的值以 <code>value</code> 取代，並回傳原本的值。
</p>
</div>
</div>

<div id="outline-container-org172ddc7" class="outline-4">
<h4 id="org172ddc7"><span class="section-number-4">5.1.25</span> <a id="org5a40067"></a> <code>zip</code></h4>
<div class="outline-text-4" id="text-5-1-25">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">zip</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">U</span><span style="color: #cccccc;">&gt;(</span><span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">other</span>: <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">U</span><span style="color: #66cccc;">&gt;</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #66cccc;">(</span><span style="color: #6699cc;">T</span>, <span style="color: #6699cc;">U</span><span style="color: #66cccc;">)</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">match</span> <span style="color: #66cccc;">(</span><span style="color: #99cc99;">self</span>, other<span style="color: #66cccc;">)</span> <span style="color: #66cccc;">{</span>
        <span style="color: #ffcc66;">(</span><span style="color: #6699cc;">Some</span><span style="color: #cccccc;">(</span>a<span style="color: #cccccc;">)</span>, <span style="color: #6699cc;">Some</span><span style="color: #cccccc;">(</span>b<span style="color: #cccccc;">)</span><span style="color: #ffcc66;">)</span> =&gt; <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span><span style="color: #cccccc;">(</span>a, b<span style="color: #cccccc;">)</span><span style="color: #ffcc66;">)</span>,
        _ =&gt; <span style="color: #6699cc;">None</span>,
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
這個方法會在兩個值都是 <code>Some</code> 的時候綁成一個元組，其餘都會回傳 <code>None</code> 。概念上是「且」運算，注意兩個所有權都會被吃掉。
</p>
</div>
</div>

<div id="outline-container-orgbe99ee9" class="outline-4">
<h4 id="orgbe99ee9"><span class="section-number-4">5.1.26</span> <a id="org0b35e89"></a> <code>copied</code></h4>
<div class="outline-text-4" id="text-5-1-26">
<p>
需要型態 <code>T</code> 有 <code>Copy</code> 特徵。
</p>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #ffcc66;">T</span>: <span style="color: #6699cc;">Copy</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span>&amp;<span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">copied</span><span style="color: #66cccc;">(</span><span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.map<span style="color: #ffcc66;">(</span>|&amp;t| t<span style="color: #ffcc66;">)</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #ffcc66;">T</span>: <span style="color: #6699cc;">Copy</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">copied</span><span style="color: #66cccc;">(</span><span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.map<span style="color: #ffcc66;">(</span>|&amp;<span style="color: #99cc99;">mut</span> t| t<span style="color: #ffcc66;">)</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
兩個實作十分相近，都是利用閉包特性進行複製。
</p>
</div>
</div>

<div id="outline-container-orgae9f33a" class="outline-4">
<h4 id="orgae9f33a"><span class="section-number-4">5.1.27</span> <a id="orge56342d"></a> <code>cloned</code></h4>
<div class="outline-text-4" id="text-5-1-27">
<p>
需要型態 <code>T</code> 有 <code>Clone</code> 特徵。
</p>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #ffcc66;">T</span>: <span style="color: #6699cc;">Clone</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span>&amp;<span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">cloned</span><span style="color: #66cccc;">(</span><span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.map<span style="color: #ffcc66;">(</span>|t| t.clone<span style="color: #cccccc;">()</span><span style="color: #ffcc66;">)</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #ffcc66;">T</span>: <span style="color: #6699cc;">Clone</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">cloned</span><span style="color: #66cccc;">(</span><span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.map<span style="color: #ffcc66;">(</span>|t| t.clone<span style="color: #cccccc;">()</span><span style="color: #ffcc66;">)</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
由於有強解參照，不用像上面的 <a href="#org0b35e89">copied()</a> 一樣特別去寫閉包參數。
</p>
</div>
</div>

<div id="outline-container-orgce30917" class="outline-4">
<h4 id="orgce30917"><span class="section-number-4">5.1.28</span> <a id="orgf0d3077"></a> <code>unwrap_or_default</code></h4>
<div class="outline-text-4" id="text-5-1-28">
<p>
需要型態 <code>T</code> 有 <code>Default</code> 特徵。
</p>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #ffcc66;">T</span>: <span style="color: #6699cc;">Default</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">unwrap_or_default</span><span style="color: #66cccc;">(</span><span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">T</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">match</span> <span style="color: #99cc99;">self</span> <span style="color: #ffcc66;">{</span>
            <span style="color: #6699cc;">Some</span><span style="color: #cccccc;">(</span>x<span style="color: #cccccc;">)</span> =&gt; x,
            <span style="color: #6699cc;">None</span> =&gt; <span style="color: #6699cc;">Default</span>::default<span style="color: #cccccc;">()</span>,
        <span style="color: #ffcc66;">}</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
非常簡單的一個 <code>match</code> 解決。
</p>
</div>
</div>

<div id="outline-container-org07fc28d" class="outline-4">
<h4 id="org07fc28d"><span class="section-number-4">5.1.29</span> <a id="orgc1055be"></a> <code>as_deref</code></h4>
<div class="outline-text-4" id="text-5-1-29">
<p>
需要型態 <code>T</code> 有 <a href="https://doc.rust-lang.org/core/ops/trait.Deref.html">Deref</a> 特徵。
</p>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #ffcc66;">T</span>: <span style="color: #6699cc;">Deref</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">as_deref</span><span style="color: #66cccc;">(</span>&amp;<span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span>&amp;<span style="color: #6699cc;">T</span>::<span style="color: #6699cc;">Target</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.as_ref<span style="color: #ffcc66;">()</span>.map<span style="color: #ffcc66;">(</span>|t| t.deref<span style="color: #cccccc;">()</span><span style="color: #ffcc66;">)</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
用 <code>as_ref()</code> 取得 <code>&amp;T</code> 後，再用 <code>map()</code> 裡的 <code>deref()</code> 與強制解參，得到 <code>T</code> 型態的解參照型態 <code>&amp;T::Target</code> 。
</p>
</div>
</div>

<div id="outline-container-org8cdea00" class="outline-4">
<h4 id="org8cdea00"><span class="section-number-4">5.1.30</span> <a id="orge4275af"></a> <code>as_deref_mut</code></h4>
<div class="outline-text-4" id="text-5-1-30">
<p>
需要型態 <code>T</code> 有 <a href="https://doc.rust-lang.org/core/ops/trait.DerefMut.html">DerefMut</a> 特徵。
</p>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #ffcc66;">T</span>: <span style="color: #6699cc;">DerefMut</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">as_deref_mut</span><span style="color: #66cccc;">(</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #6699cc;">T</span>::<span style="color: #6699cc;">Target</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.as_mut<span style="color: #ffcc66;">()</span>.map<span style="color: #ffcc66;">(</span>|t| t.deref_mut<span style="color: #cccccc;">()</span><span style="color: #ffcc66;">)</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
與上面接近，回傳型態不同。
</p>
</div>
</div>

<div id="outline-container-org5a35880" class="outline-4">
<h4 id="org5a35880"><span class="section-number-4">5.1.31</span> <a id="orgc42eab9"></a> <code>transpose</code></h4>
<div class="outline-text-4" id="text-5-1-31">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span>, <span style="color: #6699cc;">E</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">Result</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">T</span>, <span style="color: #6699cc;">E</span><span style="color: #66cccc;">&gt;</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">transpose</span><span style="color: #66cccc;">(</span><span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Result</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">Option</span><span style="color: #ffcc66;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #ffcc66;">&gt;</span>, <span style="color: #6699cc;">E</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">match</span> <span style="color: #99cc99;">self</span> <span style="color: #ffcc66;">{</span>
            <span style="color: #6699cc;">Some</span><span style="color: #cccccc;">(</span><span style="color: #6699cc;">Ok</span><span style="color: #66cccc;">(</span>x<span style="color: #66cccc;">)</span><span style="color: #cccccc;">)</span> =&gt; <span style="color: #6699cc;">Ok</span><span style="color: #cccccc;">(</span><span style="color: #6699cc;">Some</span><span style="color: #66cccc;">(</span>x<span style="color: #66cccc;">)</span><span style="color: #cccccc;">)</span>,
            <span style="color: #6699cc;">Some</span><span style="color: #cccccc;">(</span><span style="color: #6699cc;">Err</span><span style="color: #66cccc;">(</span>e<span style="color: #66cccc;">)</span><span style="color: #cccccc;">)</span> =&gt; <span style="color: #6699cc;">Err</span><span style="color: #cccccc;">(</span>e<span style="color: #cccccc;">)</span>,
            <span style="color: #6699cc;">None</span> =&gt; <span style="color: #6699cc;">Ok</span><span style="color: #cccccc;">(</span><span style="color: #6699cc;">None</span><span style="color: #cccccc;">)</span>,
        <span style="color: #ffcc66;">}</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
將 <code>Option&lt;Result&lt;T, E&gt;&gt;</code> 轉成 <code>Result&lt;Option&lt;T&gt;, E&gt;</code> ，用 <code>match</code> 做簡單的對應就解決了。
</p>
</div>
</div>
</div>

<div id="outline-container-orgf88c010" class="outline-3">
<h3 id="orgf88c010"><span class="section-number-3">5.2</span> Unstable</h3>
<div class="outline-text-3" id="text-5-2">
</div>
<div id="outline-container-org51caef4" class="outline-4">
<h4 id="org51caef4"><span class="section-number-4">5.2.1</span> <a id="orga72ec26"></a> <code>contains</code></h4>
<div class="outline-text-4" id="text-5-2-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #cccccc;">]</span>
<span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">unstable</span><span style="color: #66cccc;">(</span><span style="color: #cc99cc;">feature = </span><span style="color: #66cccc;">"option_result_contains"</span><span style="color: #cc99cc;">, issue = </span><span style="color: #66cccc;">"62358"</span><span style="color: #66cccc;">)</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">contains</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">U</span><span style="color: #cccccc;">&gt;(</span>&amp;<span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">x</span>: &amp;<span style="color: #6699cc;">U</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">bool</span>
<span style="color: #99cc99;">where</span>
    <span style="color: #ffcc66;">U</span>: <span style="color: #6699cc;">PartialEq</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span>,
<span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">match</span> <span style="color: #99cc99;">self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>y<span style="color: #ffcc66;">)</span> =&gt; x == y,
        <span style="color: #6699cc;">None</span> =&gt; <span style="color: #99cc99;">false</span>,
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
從定義看出，這段程式碼在使用了特徵綁定後不需限於同型態，只需要單向的 <code>PartialEq</code> 特徵即可。
</p>
</div>
</div>

<div id="outline-container-org18edcb8" class="outline-4">
<h4 id="org18edcb8"><span class="section-number-4">5.2.2</span> <a id="org934376c"></a> <code>zip_with</code></h4>
<div class="outline-text-4" id="text-5-2-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">unstable</span><span style="color: #66cccc;">(</span><span style="color: #cc99cc;">feature = </span><span style="color: #66cccc;">"option_zip"</span><span style="color: #cc99cc;">, issue = </span><span style="color: #66cccc;">"70086"</span><span style="color: #66cccc;">)</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">zip_with</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">U</span>, <span style="color: #6699cc;">F</span>, <span style="color: #6699cc;">R</span><span style="color: #cccccc;">&gt;(</span><span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">other</span>: <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">U</span><span style="color: #66cccc;">&gt;</span>, <span style="color: #ffcc66;">f</span>: <span style="color: #6699cc;">F</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">R</span><span style="color: #cccccc;">&gt;</span>
<span style="color: #99cc99;">where</span>
    <span style="color: #ffcc66;">F</span>: <span style="color: #6699cc;">FnOnce</span><span style="color: #cccccc;">(</span><span style="color: #6699cc;">T</span>, <span style="color: #6699cc;">U</span><span style="color: #cccccc;">)</span> -&gt; <span style="color: #6699cc;">R</span>,
<span style="color: #cccccc;">{</span>
    <span style="color: #6699cc;">Some</span><span style="color: #66cccc;">(</span>f<span style="color: #ffcc66;">(</span><span style="color: #99cc99;">self</span><span style="color: #cc99cc; font-weight: bold;">?</span>, other<span style="color: #cc99cc; font-weight: bold;">?</span><span style="color: #ffcc66;">)</span><span style="color: #66cccc;">)</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
其中的 <code>?</code> 保證當自身或 <code>other</code> 其一是 <code>None</code> 時會直接回傳 <code>None</code> ，只有兩個都是 <code>Some</code> 時才會利用 <code>f</code> 將型態 <code>T</code> 與 <code>U</code> 映射到 <code>R</code> 上。
</p>
</div>
</div>

<div id="outline-container-orgf610c7b" class="outline-4">
<h4 id="orgf610c7b"><span class="section-number-4">5.2.3</span> <a id="org5991525"></a> <code>expect_none</code></h4>
<div class="outline-text-4" id="text-5-2-3">
<p>
需要型態 <code>T</code> 有 <a href="https://doc.rust-lang.org/core/fmt/trait.Debug.html">fmt::Debug</a> 特徵。
</p>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #ffcc66;">T</span>: <span style="color: #6699cc;">fmt</span>::<span style="color: #6699cc;">Debug</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">track_caller</span><span style="color: #66cccc;">]</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">unstable</span><span style="color: #ffcc66;">(</span><span style="color: #cc99cc;">feature = </span><span style="color: #66cccc;">"option_expect_none"</span><span style="color: #cc99cc;">, reason = </span><span style="color: #66cccc;">"newly added"</span><span style="color: #cc99cc;">, issue = </span><span style="color: #66cccc;">"62633"</span><span style="color: #ffcc66;">)</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">expect_none</span><span style="color: #66cccc;">(</span><span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">msg</span>: &amp;<span style="color: #6699cc;">str</span><span style="color: #66cccc;">)</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">if</span> <span style="color: #99cc99;">let</span> <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>val<span style="color: #ffcc66;">)</span> = <span style="color: #99cc99;">self</span> <span style="color: #ffcc66;">{</span>
            expect_none_failed<span style="color: #cccccc;">(</span>msg, &amp;val<span style="color: #cccccc;">)</span>;
        <span style="color: #ffcc66;">}</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org3d65de6" class="outline-4">
<h4 id="org3d65de6"><span class="section-number-4">5.2.4</span> <code>expect_none_failed</code></h4>
<div class="outline-text-4" id="text-5-2-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #ffcc66;">T</span>: <span style="color: #6699cc;">fmt</span>::<span style="color: #6699cc;">Debug</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #ffcc66;">(</span><span style="color: #cc99cc;">never</span><span style="color: #ffcc66;">)</span><span style="color: #66cccc;">]</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">cold</span><span style="color: #66cccc;">]</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">track_caller</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">expect_none_failed</span><span style="color: #66cccc;">(</span><span style="color: #ffcc66;">msg</span>: &amp;<span style="color: #6699cc;">str</span>, <span style="color: #ffcc66;">value</span>: &amp;<span style="color: #99cc99;">dyn</span> <span style="color: #6699cc;">fmt</span>::<span style="color: #6699cc;">Debug</span><span style="color: #66cccc;">)</span> -&gt; ! <span style="color: #66cccc;">{</span>
        <span style="color: #cc99cc;">panic!</span><span style="color: #ffcc66;">(</span><span style="color: #66cccc;">"{}: {:?}"</span>, msg, value<span style="color: #ffcc66;">)</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7eb159f" class="outline-4">
<h4 id="org7eb159f"><span class="section-number-4">5.2.5</span> <a id="org5193970"></a> <code>unwrap_none</code></h4>
<div class="outline-text-4" id="text-5-2-5">
<p>
需要型態 <code>T</code> 有 <a href="https://doc.rust-lang.org/core/fmt/trait.Debug.html">fmt::Debug</a> 特徵。
</p>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #ffcc66;">T</span>: <span style="color: #6699cc;">fmt</span>::<span style="color: #6699cc;">Debug</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">track_caller</span><span style="color: #66cccc;">]</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">unstable</span><span style="color: #ffcc66;">(</span><span style="color: #cc99cc;">feature = </span><span style="color: #66cccc;">"option_unwrap_none"</span><span style="color: #cc99cc;">, reason = </span><span style="color: #66cccc;">"newly added"</span><span style="color: #cc99cc;">, issue = </span><span style="color: #66cccc;">"62633"</span><span style="color: #ffcc66;">)</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">unwrap_none</span><span style="color: #66cccc;">(</span><span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">if</span> <span style="color: #99cc99;">let</span> <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>val<span style="color: #ffcc66;">)</span> = <span style="color: #99cc99;">self</span> <span style="color: #ffcc66;">{</span>
            expect_none_failed<span style="color: #cccccc;">(</span><span style="color: #66cccc;">"called `Option::unwrap_none()` on a `Some` value"</span>, &amp;val<span style="color: #cccccc;">)</span>;
        <span style="color: #ffcc66;">}</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge3be1b1" class="outline-4">
<h4 id="orge3be1b1"><span class="section-number-4">5.2.6</span> <a id="org124d90e"></a> <code>flatten</code></h4>
<div class="outline-text-4" id="text-5-2-6">
<p>
需要為型態 <code>Option&lt;Option&lt;T&gt;&gt;</code> 。
</p>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">flatten</span><span style="color: #66cccc;">(</span><span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.and_then<span style="color: #ffcc66;">(</span><span style="color: #6699cc;">convert</span>::identity<span style="color: #ffcc66;">)</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
<a href="#org5cf213c">Use</a> 用到了 <a href="https://doc.rust-lang.org/core/convert/fn.identity.html">core::convert::identity</a> 這個函數，與 <a href="#orgccc077b">and<sub>then</sub>()</a> 這個方法，讓 <code>Some(opt)</code> 用 <code>convert::identity()</code> 轉成 <code>opt</code> ，而 <code>None</code> 則因為 <code>and_then</code> 轉成 <code>None</code> ，最後型態是 <code>Option&lt;T&gt;</code> 。
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org817b47e" class="outline-2">
<h2 id="org817b47e"><span class="section-number-2">6</span> Unsafe Methods</h2>
<div class="outline-text-2" id="text-6">
<p>
沒有這種東西。
</p>
</div>
</div>

<div id="outline-container-orge20dbee" class="outline-2">
<h2 id="orge20dbee"><span class="section-number-2">7</span> Trait Implementations</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org19ad260" class="outline-3">
<h3 id="org19ad260"><span class="section-number-3">7.1</span> <a id="org52ae4e2"></a> Clone</h3>
<div class="outline-text-3" id="text-7-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #ffcc66;">T</span>: <span style="color: #6699cc;">Clone</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">Clone</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">clone</span><span style="color: #66cccc;">(</span>&amp;<span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">match</span> <span style="color: #99cc99;">self</span> <span style="color: #ffcc66;">{</span>
            <span style="color: #6699cc;">Some</span><span style="color: #cccccc;">(</span>x<span style="color: #cccccc;">)</span> =&gt; <span style="color: #6699cc;">Some</span><span style="color: #cccccc;">(</span>x.clone<span style="color: #66cccc;">()</span><span style="color: #cccccc;">)</span>,
            <span style="color: #6699cc;">None</span> =&gt; <span style="color: #6699cc;">None</span>,
        <span style="color: #ffcc66;">}</span>
    <span style="color: #66cccc;">}</span>

    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">clone_from</span><span style="color: #66cccc;">(</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #99cc99;">self</span>, <span style="color: #ffcc66;">source</span>: &amp;<span style="color: #6699cc;">Self</span><span style="color: #66cccc;">)</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">match</span> <span style="color: #ffcc66;">(</span><span style="color: #99cc99;">self</span>, source<span style="color: #ffcc66;">)</span> <span style="color: #ffcc66;">{</span>
            <span style="color: #cccccc;">(</span><span style="color: #6699cc;">Some</span><span style="color: #66cccc;">(</span>to<span style="color: #66cccc;">)</span>, <span style="color: #6699cc;">Some</span><span style="color: #66cccc;">(</span>from<span style="color: #66cccc;">)</span><span style="color: #cccccc;">)</span> =&gt; to.clone_from<span style="color: #cccccc;">(</span>from<span style="color: #cccccc;">)</span>,
            <span style="color: #cccccc;">(</span>to, from<span style="color: #cccccc;">)</span> =&gt; *to = from.clone<span style="color: #cccccc;">()</span>,
        <span style="color: #ffcc66;">}</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
<code>clone()</code> 很簡單，就是用內容的 <code>clone()</code> 再在外面包一層 <code>Some</code> 。當 <code>clone_from()</code> 的兩個都是 <code>Some</code> 時也很簡單； <code>(Some, None)</code> 時用了 <code>Option</code> 內的 <code>clone()</code> 所以保證會複製到 <code>None</code> ； <code>(None, Some)</code> 時自身的值被 <code>Some</code> 裡面的值更新，所以也保證會複製到 <code>Some</code> ； <code>(None, None)</code> 時則保證會複製到 <code>None</code> 。
</p>
</div>
</div>


<div id="outline-container-org32d0bd7" class="outline-3">
<h3 id="org32d0bd7"><span class="section-number-3">7.2</span> <a id="orgcb45a95"></a> Default</h3>
<div class="outline-text-3" id="text-7-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">Default</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">default</span><span style="color: #66cccc;">()</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">None</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
預設值是 <code>None</code> 。所以不需要型態 <code>T</code> 有任何的 <code>Default</code> 實作。
</p>
</div>
</div>

<div id="outline-container-orga4dfbe0" class="outline-3">
<h3 id="orga4dfbe0"><span class="section-number-3">7.3</span> <a id="org9076b3e"></a> IntoIterator</h3>
<div class="outline-text-3" id="text-7-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">IntoIterator</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">type</span> <span style="color: #6699cc;">Item</span> = <span style="color: #6699cc;">T</span>;
    <span style="color: #99cc99;">type</span> <span style="color: #6699cc;">IntoIter</span> = <span style="color: #6699cc;">IntoIter</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span>;

    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">into_iter</span><span style="color: #66cccc;">(</span><span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">IntoIter</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">IntoIter</span> <span style="color: #ffcc66;">{</span> <span style="color: #ffcc66;">inner</span>: <span style="color: #6699cc;">Item</span> <span style="color: #cccccc;">{</span> <span style="color: #ffcc66;">opt</span>: <span style="color: #99cc99;">self</span> <span style="color: #cccccc;">}</span> <span style="color: #ffcc66;">}</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
建立一個 <a href="#org657c0ff">IntoIter</a> 結構，會把所有權拿走。
</p>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">a</span>, <span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">IntoIterator</span> <span style="color: #99cc99;">for</span> &amp;'<span style="color: #ffcc66;">a</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">type</span> <span style="color: #6699cc;">Item</span> = &amp;'<span style="color: #ffcc66;">a</span> <span style="color: #6699cc;">T</span>;
    <span style="color: #99cc99;">type</span> <span style="color: #6699cc;">IntoIter</span> = <span style="color: #6699cc;">Iter</span><span style="color: #66cccc;">&lt;</span>'<span style="color: #ffcc66;">a</span>, <span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span>;

    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">into_iter</span><span style="color: #66cccc;">(</span><span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Iter</span><span style="color: #66cccc;">&lt;</span>'<span style="color: #ffcc66;">a</span>, <span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.iter<span style="color: #ffcc66;">()</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
這邊直接使用了 <a href="#orgcb4dceb">Iter</a> 結構。
</p>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">a</span>, <span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">IntoIterator</span> <span style="color: #99cc99;">for</span> &amp;'<span style="color: #ffcc66;">a</span> <span style="color: #99cc99;">mut</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">type</span> <span style="color: #6699cc;">Item</span> = &amp;'<span style="color: #ffcc66;">a</span> <span style="color: #99cc99;">mut</span> <span style="color: #6699cc;">T</span>;
    <span style="color: #99cc99;">type</span> <span style="color: #6699cc;">IntoIter</span> = <span style="color: #6699cc;">IterMut</span><span style="color: #66cccc;">&lt;</span>'<span style="color: #ffcc66;">a</span>, <span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span>;

    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">into_iter</span><span style="color: #66cccc;">(</span><span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">IterMut</span><span style="color: #66cccc;">&lt;</span>'<span style="color: #ffcc66;">a</span>, <span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.iter_mut<span style="color: #ffcc66;">()</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
這邊直接使用了 <a href="#org662dc35">IterMut</a> 結構。
</p>
</div>
</div>

<div id="outline-container-org33a4279" class="outline-3">
<h3 id="org33a4279"><span class="section-number-3">7.4</span> <a id="org19cf54b"></a> From</h3>
<div class="outline-text-3" id="text-7-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">From</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">from</span><span style="color: #66cccc;">(</span><span style="color: #ffcc66;">val</span>: <span style="color: #6699cc;">T</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>val<span style="color: #ffcc66;">)</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
這邊會直接把 <code>val</code> 的所有權吃掉，必定轉成 <code>Some</code> 。
</p>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">a</span>, <span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">From</span><span style="color: #cccccc;">&lt;</span>&amp;'<span style="color: #ffcc66;">a</span> <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span><span style="color: #cccccc;">&gt;</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span>&amp;'<span style="color: #ffcc66;">a</span> <span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">from</span><span style="color: #66cccc;">(</span><span style="color: #ffcc66;">o</span>: &amp;'<span style="color: #ffcc66;">a</span> <span style="color: #6699cc;">Option</span><span style="color: #ffcc66;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #ffcc66;">&gt;</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span>&amp;'<span style="color: #ffcc66;">a</span> <span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        o.as_ref<span style="color: #ffcc66;">()</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
這邊會複製的是參照，生命期為 <code>o</code> 的參照來源。使用了 <a href="#orgc447352">as<sub>ref</sub>()</a> 方法，所以可以將型態從 <code>&amp;Option&lt;T&gt;</code> 轉為 <code>Option&lt;&amp;T&gt;</code> 而且不複製到內容物本身。
</p>

<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">a</span>, <span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">From</span><span style="color: #cccccc;">&lt;</span>&amp;'<span style="color: #ffcc66;">a</span> <span style="color: #99cc99;">mut</span> <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span><span style="color: #cccccc;">&gt;</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span>&amp;'<span style="color: #ffcc66;">a</span> <span style="color: #99cc99;">mut</span> <span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">from</span><span style="color: #66cccc;">(</span><span style="color: #ffcc66;">o</span>: &amp;'<span style="color: #ffcc66;">a</span> <span style="color: #99cc99;">mut</span> <span style="color: #6699cc;">Option</span><span style="color: #ffcc66;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #ffcc66;">&gt;</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span>&amp;'<span style="color: #ffcc66;">a</span> <span style="color: #99cc99;">mut</span> <span style="color: #6699cc;">T</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        o.as_mut<span style="color: #ffcc66;">()</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
這邊複製一個可變參照，生命期為 <code>o</code> 的參照來源。使用了 <a href="#orgde469bf">as<sub>mut</sub>()</a> 方法，所以可以將型態從 <code>&amp;mut Option&lt;T&gt;</code> 轉為 <code>Option&lt;&amp;mut T&gt;</code> 而不複製內容易本身。
</p>
</div>
</div>

<div id="outline-container-org2f99732" class="outline-3">
<h3 id="org2f99732"><span class="section-number-3">7.5</span> <a id="org5b7a119"></a> FromIterator</h3>
<div class="outline-text-3" id="text-7-5">
<div class="org-src-container">
<pre class="src src-rust">
<span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span>, <span style="color: #ffcc66;">V</span>: <span style="color: #6699cc;">FromIterator</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #66cccc;">&gt;</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">FromIterator</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #66cccc;">&gt;</span><span style="color: #cccccc;">&gt;</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">V</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">from_iter</span><span style="color: #66cccc;">&lt;</span><span style="color: #ffcc66;">I</span>: <span style="color: #6699cc;">IntoIterator</span><span style="color: #ffcc66;">&lt;</span><span style="color: #6699cc;">Item</span> = <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span><span style="color: #ffcc66;">&gt;</span><span style="color: #66cccc;">&gt;(</span><span style="color: #ffcc66;">iter</span>: <span style="color: #6699cc;">I</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">V</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #999999; font-style: italic;">// </span><span style="color: #f2777a; font-weight: bold;">FIXME</span><span style="color: #999999; font-style: italic;">(#11084): This could be replaced with Iterator::scan when this</span>
        <span style="color: #999999; font-style: italic;">// </span><span style="color: #999999; font-style: italic;">performance bug is closed.</span>

        iter.into_iter<span style="color: #ffcc66;">()</span>.map<span style="color: #ffcc66;">(</span>|x| x.ok_or<span style="color: #cccccc;">(</span><span style="color: #66cccc;">()</span><span style="color: #cccccc;">)</span><span style="color: #ffcc66;">)</span>.collect::<span style="color: #ffcc66;">&lt;</span><span style="color: #6699cc;">Result</span><span style="color: #cccccc;">&lt;</span>_, _<span style="color: #cccccc;">&gt;</span><span style="color: #ffcc66;">&gt;()</span>.ok<span style="color: #ffcc66;">()</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
註解裡提到的 <a href="https://doc.rust-lang.org/core/iter/trait.Iterator.html#method.scan">Iterator::scan</a> 是創出新的迭代器的方法。參數 <code>iter</code> 的型態 <code>I</code> 必須要有 <code>IntoIterator</code> 中 <code>Item = Option&lt;A&gt;</code> 的實作；最後的回傳型態 <code>V</code> 則必須要有 <code>FromIterator</code> 中型態 <code>A</code> 的實作。首先是把參數 <code>iter</code> 用 <code>into_iter()</code> 轉成 <code>IntoIterator</code> ，再用 <code>map()</code> 將每個型態為 <code>Option&lt;A&gt;</code> 的元素 <code>x</code> 用 <code>ok_or()</code> 轉成型態 <code>Result&lt;A, ()&gt;</code> ，此時外面型態是 <code>Map&lt;Self, F&gt;</code> ，然後用 <code>IntoIterator</code> 的方法 <code>collect()</code> 做成 <code>Result&lt;V, ()&gt;</code> ，最後再用 <code>Result</code> 的方法 <code>ok()</code> 轉回 <code>Option&lt;V&gt;</code> 。
</p>
</div>
</div>

<div id="outline-container-orgfef48a0" class="outline-3">
<h3 id="orgfef48a0"><span class="section-number-3">7.6</span> <a id="org9483fb9"></a> ops::Try (Unstable)</h3>
<div class="outline-text-3" id="text-7-6">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">unstable</span><span style="color: #66cccc;">(</span><span style="color: #cc99cc;">feature = </span><span style="color: #66cccc;">"try_trait"</span><span style="color: #cc99cc;">, issue = </span><span style="color: #66cccc;">"42327"</span><span style="color: #66cccc;">)</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">ops</span>::<span style="color: #6699cc;">Try</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">Option</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">T</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">type</span> <span style="color: #6699cc;">Ok</span> = <span style="color: #6699cc;">T</span>;
    <span style="color: #99cc99;">type</span> <span style="color: #6699cc;">Error</span> = <span style="color: #6699cc;">NoneError</span>;

    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">into_result</span><span style="color: #66cccc;">(</span><span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Result</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">T</span>, <span style="color: #6699cc;">NoneError</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.ok_or<span style="color: #ffcc66;">(</span><span style="color: #6699cc;">NoneError</span><span style="color: #ffcc66;">)</span>
    <span style="color: #66cccc;">}</span>

    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">from_ok</span><span style="color: #66cccc;">(</span><span style="color: #ffcc66;">v</span>: <span style="color: #6699cc;">T</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">Some</span><span style="color: #ffcc66;">(</span>v<span style="color: #ffcc66;">)</span>
    <span style="color: #66cccc;">}</span>

    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">from_error</span><span style="color: #66cccc;">(</span><span style="color: #ffcc66;">_</span>: <span style="color: #6699cc;">NoneError</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">None</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
這個以後可能用來取代 <a href="#orgf522a5b">ok<sub>or</sub>()</a> 等等方法，以一個 <code>?</code> 就回傳 <code>Result</code> 型態。
</p>
</div>
</div>
</div>

<div id="outline-container-org66ca0c0" class="outline-2">
<h2 id="org66ca0c0"><span class="section-number-2">8</span> Structs</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-orga9253f5" class="outline-3">
<h3 id="orga9253f5"><span class="section-number-3">8.1</span> <a id="org98a4652"></a> Item</h3>
<div class="outline-text-3" id="text-8-1">
</div>
<div id="outline-container-org4ee1135" class="outline-4">
<h4 id="org4ee1135"><span class="section-number-4">8.1.1</span> Definition</h4>
<div class="outline-text-4" id="text-8-1-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">derive</span><span style="color: #66cccc;">(</span><span style="color: #cc99cc;">Clone, Debug</span><span style="color: #66cccc;">)</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">struct</span> <span style="color: #6699cc;">Item</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #ffcc66;">opt</span>: <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #66cccc;">&gt;</span>,
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
<a href="#orgcb4dceb">Iter</a> 內的欄位結構。
</p>
</div>
</div>


<div id="outline-container-org503cc93" class="outline-4">
<h4 id="org503cc93"><span class="section-number-4">8.1.2</span> Trait Implementations</h4>
<div class="outline-text-4" id="text-8-1-2">
</div>
<ol class="org-ol">
<li><a id="orgebfe1da"></a>Iterator<br />
<div class="outline-text-5" id="text-8-1-2-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">Iterator</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">Item</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">type</span> <span style="color: #6699cc;">Item</span> = <span style="color: #6699cc;">A</span>;

    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">next</span><span style="color: #66cccc;">(</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.opt.take<span style="color: #ffcc66;">()</span>
    <span style="color: #66cccc;">}</span>

    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">size_hint</span><span style="color: #66cccc;">(</span>&amp;<span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #66cccc;">(</span><span style="color: #6699cc;">usize</span>, <span style="color: #6699cc;">Option</span><span style="color: #ffcc66;">&lt;</span><span style="color: #6699cc;">usize</span><span style="color: #ffcc66;">&gt;</span><span style="color: #66cccc;">)</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">match</span> <span style="color: #99cc99;">self</span>.opt <span style="color: #ffcc66;">{</span>
            <span style="color: #6699cc;">Some</span><span style="color: #cccccc;">(</span>_<span style="color: #cccccc;">)</span> =&gt; <span style="color: #cccccc;">(</span><span style="color: #6699cc;">1</span>, <span style="color: #6699cc;">Some</span><span style="color: #66cccc;">(</span><span style="color: #6699cc;">1</span><span style="color: #66cccc;">)</span><span style="color: #cccccc;">)</span>,
            <span style="color: #6699cc;">None</span> =&gt; <span style="color: #cccccc;">(</span><span style="color: #6699cc;">0</span>, <span style="color: #6699cc;">Some</span><span style="color: #66cccc;">(</span><span style="color: #6699cc;">0</span><span style="color: #66cccc;">)</span><span style="color: #cccccc;">)</span>,
        <span style="color: #ffcc66;">}</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
實作上使用 <a href="#org363d475">take()</a> 這個方法達成。 其中的 <code>size_hint()</code> 因為非常簡單所以用 <code>match</code> 來加速。
</p>
</div>
</li>

<li><a id="orgf03a606"></a>DoubleEndedIterator<br />
<div class="outline-text-5" id="text-8-1-2-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">DoubleEndedIterator</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">Item</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">next_back</span><span style="color: #66cccc;">(</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.opt.take<span style="color: #ffcc66;">()</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
因為在內有東西時從前面往後看與從後往前是一樣的，所以與上面的 <code>next()</code> 寫法一樣即可。
</p>
</div>
</li>

<li><a id="org3dcb1ad"></a>ExactSizeIterator<br />
<div class="outline-text-5" id="text-8-1-2-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">ExactSizeIterator</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">Item</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{}</span>
</pre>
</div>
</div>
</li>

<li><a id="orge923e94"></a>FusedIterator<br />
<div class="outline-text-5" id="text-8-1-2-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">FusedIterator</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">Item</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{}</span>
</pre>
</div>
</div>
</li>

<li><a id="org93990ac"></a>TrustedLen<br />
<div class="outline-text-5" id="text-8-1-2-5">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #f2777a; font-weight: bold;">unsafe</span> <span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">TrustedLen</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">Item</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{}</span>
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-org4f784b8" class="outline-3">
<h3 id="org4f784b8"><span class="section-number-3">8.2</span> <a id="orgcb4dceb"></a> Iter</h3>
<div class="outline-text-3" id="text-8-2">
<p>
<a href="#org018c460">iter()</a> 所回傳的結構。
</p>
</div>

<div id="outline-container-orga3462c9" class="outline-4">
<h4 id="orga3462c9"><span class="section-number-4">8.2.1</span> Definition</h4>
<div class="outline-text-4" id="text-8-2-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">derive</span><span style="color: #66cccc;">(</span><span style="color: #cc99cc;">Debug</span><span style="color: #66cccc;">)</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">struct</span> <span style="color: #6699cc;">Iter</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">a</span>, <span style="color: #ffcc66;">A</span>: '<span style="color: #ffcc66;">a</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #ffcc66;">inner</span>: <span style="color: #6699cc;">Item</span><span style="color: #66cccc;">&lt;</span>&amp;'<span style="color: #ffcc66;">a</span> <span style="color: #6699cc;">A</span><span style="color: #66cccc;">&gt;</span>,
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
借用的生命期為 <code>a</code> ，而結構本身的生命期也為 <code>a</code> 。
</p>
</div>
</div>

<div id="outline-container-org797c545" class="outline-4">
<h4 id="org797c545"><span class="section-number-4">8.2.2</span> Trait Implementations</h4>
<div class="outline-text-4" id="text-8-2-2">
</div>
<ol class="org-ol">
<li><a id="org560c0e3"></a>Iterator<br />
<div class="outline-text-5" id="text-8-2-2-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">a</span>, <span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">Iterator</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">Iter</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">a</span>, <span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">type</span> <span style="color: #6699cc;">Item</span> = &amp;'<span style="color: #ffcc66;">a</span> <span style="color: #6699cc;">A</span>;

    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">next</span><span style="color: #66cccc;">(</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span>&amp;'<span style="color: #ffcc66;">a</span> <span style="color: #6699cc;">A</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.inner.next<span style="color: #ffcc66;">()</span>
    <span style="color: #66cccc;">}</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">size_hint</span><span style="color: #66cccc;">(</span>&amp;<span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #66cccc;">(</span><span style="color: #6699cc;">usize</span>, <span style="color: #6699cc;">Option</span><span style="color: #ffcc66;">&lt;</span><span style="color: #6699cc;">usize</span><span style="color: #ffcc66;">&gt;</span><span style="color: #66cccc;">)</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.inner.size_hint<span style="color: #ffcc66;">()</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
利用了另一個結構 <a href="#org98a4652">Item</a> 簡化了麻煩的生命期標註，這邊只做呼叫內部的方法完成。
</p>
</div>
</li>

<li><a id="org418bd7d"></a>DoubleEndedIterator<br />
<div class="outline-text-5" id="text-8-2-2-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">a</span>, <span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">DoubleEndedIterator</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">Iter</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">a</span>, <span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">next_back</span><span style="color: #66cccc;">(</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span>&amp;'<span style="color: #ffcc66;">a</span> <span style="color: #6699cc;">A</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.inner.next_back<span style="color: #ffcc66;">()</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>
</div>
</li>

<li><a id="org4e831d5"></a>ExactSizeIterator<br />
<div class="outline-text-5" id="text-8-2-2-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">ExactSizeIterator</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">Iter</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">_</span>, <span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{}</span>
</pre>
</div>
</div>
</li>

<li><a id="org1bd9297"></a>FusedIterator<br />
<div class="outline-text-5" id="text-8-2-2-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">FusedIterator</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">Iter</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">_</span>, <span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{}</span>
</pre>
</div>
</div>
</li>

<li><a id="orgce31fd0"></a>Clone<br />
<div class="outline-text-5" id="text-8-2-2-5">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">Clone</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">Iter</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">_</span>, <span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">clone</span><span style="color: #66cccc;">(</span>&amp;<span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Self</span> <span style="color: #66cccc;">{</span>
        <span style="color: #6699cc;">Iter</span> <span style="color: #ffcc66;">{</span> <span style="color: #ffcc66;">inner</span>: <span style="color: #99cc99;">self</span>.inner.clone<span style="color: #cccccc;">()</span> <span style="color: #ffcc66;">}</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
不使用 <code>derive</code> 巨集，而是明確呼叫 <a href="#org98a4652">Item</a> 的 <code>clone()</code> 。
</p>
</div>
</li>

<li><a id="org667e0a3"></a>TrustedLen (Unstable)<br />
<div class="outline-text-5" id="text-8-2-2-6">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">unstable</span><span style="color: #66cccc;">(</span><span style="color: #cc99cc;">feature = </span><span style="color: #66cccc;">"trusted_len"</span><span style="color: #cc99cc;">, issue = </span><span style="color: #66cccc;">"37572"</span><span style="color: #66cccc;">)</span><span style="color: #cccccc;">]</span>
<span style="color: #f2777a; font-weight: bold;">unsafe</span> <span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">TrustedLen</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">Iter</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">_</span>, <span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{}</span>
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-orgbfe7556" class="outline-3">
<h3 id="orgbfe7556"><span class="section-number-3">8.3</span> <a id="org662dc35"></a> IterMut</h3>
<div class="outline-text-3" id="text-8-3">
<p>
<a href="#org7e13977">iter<sub>mut</sub>()</a> 所回傳的結構。
</p>
</div>

<div id="outline-container-org9b2ca75" class="outline-4">
<h4 id="org9b2ca75"><span class="section-number-4">8.3.1</span> Definition</h4>
<div class="outline-text-4" id="text-8-3-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">derive</span><span style="color: #66cccc;">(</span><span style="color: #cc99cc;">Debug</span><span style="color: #66cccc;">)</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">struct</span> <span style="color: #6699cc;">IterMut</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">a</span>, <span style="color: #ffcc66;">A</span>: '<span style="color: #ffcc66;">a</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #ffcc66;">inner</span>: <span style="color: #6699cc;">Item</span><span style="color: #66cccc;">&lt;</span>&amp;'<span style="color: #ffcc66;">a</span> <span style="color: #99cc99;">mut</span> <span style="color: #6699cc;">A</span><span style="color: #66cccc;">&gt;</span>,
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
與上方的<a href="#orgcb4dceb">Iter</a> 不同的是多了一個 <code>mut</code> 借用。
</p>
</div>
</div>

<div id="outline-container-orgbe345aa" class="outline-4">
<h4 id="orgbe345aa"><span class="section-number-4">8.3.2</span> Trait Implementations</h4>
<div class="outline-text-4" id="text-8-3-2">
</div>
<ol class="org-ol">
<li><a id="org409c9be"></a>Iterator<br />
<div class="outline-text-5" id="text-8-3-2-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">a</span>, <span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">Iterator</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">IterMut</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">a</span>, <span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">type</span> <span style="color: #6699cc;">Item</span> = &amp;'<span style="color: #ffcc66;">a</span> <span style="color: #99cc99;">mut</span> <span style="color: #6699cc;">A</span>;

    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">next</span><span style="color: #66cccc;">(</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span>&amp;'<span style="color: #ffcc66;">a</span> <span style="color: #99cc99;">mut</span> <span style="color: #6699cc;">A</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.inner.next<span style="color: #ffcc66;">()</span>
    <span style="color: #66cccc;">}</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">size_hint</span><span style="color: #66cccc;">(</span>&amp;<span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #66cccc;">(</span><span style="color: #6699cc;">usize</span>, <span style="color: #6699cc;">Option</span><span style="color: #ffcc66;">&lt;</span><span style="color: #6699cc;">usize</span><span style="color: #ffcc66;">&gt;</span><span style="color: #66cccc;">)</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.inner.size_hint<span style="color: #ffcc66;">()</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
所有的實作都交由 <a href="#org98a4652">Item</a> 完成， <a href="#orgcb4dceb">Iter</a> 與 <a href="#org662dc35">IterMut</a> 只負責做出泛型的不同借用，非常高的抽象程度。
</p>
</div>
</li>

<li><a id="org6eb6c6e"></a>DoubleEndedIterator<br />
<div class="outline-text-5" id="text-8-3-2-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">a</span>, <span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">DoubleEndedIterator</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">IterMut</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">a</span>, <span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">next_back</span><span style="color: #66cccc;">(</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span>&amp;'<span style="color: #ffcc66;">a</span> <span style="color: #99cc99;">mut</span> <span style="color: #6699cc;">A</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.inner.next_back<span style="color: #ffcc66;">()</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>
</div>
</li>

<li><a id="org9ce27b6"></a>ExactSizeIterator<br />
<div class="outline-text-5" id="text-8-3-2-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">ExactSizeIterator</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">IterMut</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">_</span>, <span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{}</span>
</pre>
</div>
</div>
</li>

<li><a id="orgcddbfe5"></a>FusedIterator<br />
<div class="outline-text-5" id="text-8-3-2-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">FusedIterator</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">IterMut</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">_</span>, <span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{}</span>
</pre>
</div>
</div>
</li>

<li><a id="orga6e2429"></a>TrustedLen (Unstable)<br />
<div class="outline-text-5" id="text-8-3-2-5">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #f2777a; font-weight: bold;">unsafe</span> <span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">TrustedLen</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">IterMut</span><span style="color: #cccccc;">&lt;</span>'<span style="color: #ffcc66;">_</span>, <span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{}</span>
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-org720c460" class="outline-3">
<h3 id="org720c460"><span class="section-number-3">8.4</span> <a id="org657c0ff"></a> IntoIter</h3>
<div class="outline-text-3" id="text-8-4">
<p>
<a href="#org9076b3e">IntoIterator</a> 所回傳的結構。
</p>
</div>

<div id="outline-container-org514c890" class="outline-4">
<h4 id="org514c890"><span class="section-number-4">8.4.1</span> Definition</h4>
<div class="outline-text-4" id="text-8-4-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">derive</span><span style="color: #66cccc;">(</span><span style="color: #cc99cc;">Clone, Debug</span><span style="color: #66cccc;">)</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">struct</span> <span style="color: #6699cc;">IntoIter</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #ffcc66;">inner</span>: <span style="color: #6699cc;">Item</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #66cccc;">&gt;</span>,
<span style="color: #cccccc;">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org41c01d1" class="outline-4">
<h4 id="org41c01d1"><span class="section-number-4">8.4.2</span> Trait Implementations</h4>
<div class="outline-text-4" id="text-8-4-2">
</div>
<ol class="org-ol">
<li><a id="org254fca9"></a>Iterator<br />
<div class="outline-text-5" id="text-8-4-2-1">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">Iterator</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">IntoIter</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #99cc99;">type</span> <span style="color: #6699cc;">Item</span> = <span style="color: #6699cc;">A</span>;

    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">next</span><span style="color: #66cccc;">(</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.inner.next<span style="color: #ffcc66;">()</span>
    <span style="color: #66cccc;">}</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">size_hint</span><span style="color: #66cccc;">(</span>&amp;<span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #66cccc;">(</span><span style="color: #6699cc;">usize</span>, <span style="color: #6699cc;">Option</span><span style="color: #ffcc66;">&lt;</span><span style="color: #6699cc;">usize</span><span style="color: #ffcc66;">&gt;</span><span style="color: #66cccc;">)</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.inner.size_hint<span style="color: #ffcc66;">()</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>

<p>
與前面都一樣，利用了共同的內容結構 <a href="#org98a4652">Item</a> 的實作完成特徵的實作。
</p>
</div>
</li>

<li><a id="orgcd5b06e"></a>DoubleEndedIterator<br />
<div class="outline-text-5" id="text-8-4-2-2">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">DoubleEndedIterator</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">IntoIter</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{</span>
    <span style="color: #cc99cc;">#</span><span style="color: #66cccc;">[</span><span style="color: #cc99cc;">inline</span><span style="color: #66cccc;">]</span>
    <span style="color: #99cc99;">fn</span> <span style="color: #f99157;">next_back</span><span style="color: #66cccc;">(</span>&amp;<span style="color: #99cc99;">mut</span> <span style="color: #99cc99;">self</span><span style="color: #66cccc;">)</span> -&gt; <span style="color: #6699cc;">Option</span><span style="color: #66cccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #66cccc;">&gt;</span> <span style="color: #66cccc;">{</span>
        <span style="color: #99cc99;">self</span>.inner.next_back<span style="color: #ffcc66;">()</span>
    <span style="color: #66cccc;">}</span>
<span style="color: #cccccc;">}</span>
</pre>
</div>
</div>
</li>

<li><a id="org7cbe14e"></a>ExactSizeIterator<br />
<div class="outline-text-5" id="text-8-4-2-3">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">ExactSizeIterator</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">IntoIter</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{}</span>
</pre>
</div>
</div>
</li>

<li><a id="org945f5e8"></a>FusedIterator<br />
<div class="outline-text-5" id="text-8-4-2-4">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">FusedIterator</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">IntoIter</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{}</span>
</pre>
</div>
</div>
</li>

<li><a id="org1b37523"></a>TrustedLen<br />
<div class="outline-text-5" id="text-8-4-2-5">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">unstable</span><span style="color: #66cccc;">(</span><span style="color: #cc99cc;">feature = </span><span style="color: #66cccc;">"trusted_len"</span><span style="color: #cc99cc;">, issue = </span><span style="color: #66cccc;">"37572"</span><span style="color: #66cccc;">)</span><span style="color: #cccccc;">]</span>
<span style="color: #f2777a; font-weight: bold;">unsafe</span> <span style="color: #99cc99;">impl</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #6699cc;">TrustedLen</span> <span style="color: #99cc99;">for</span> <span style="color: #6699cc;">IntoIter</span><span style="color: #cccccc;">&lt;</span><span style="color: #6699cc;">A</span><span style="color: #cccccc;">&gt;</span> <span style="color: #cccccc;">{}</span>
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-org3bda798" class="outline-3">
<h3 id="org3bda798"><span class="section-number-3">8.5</span> <a id="orga5a1632"></a> NoneError (Unstable)</h3>
<div class="outline-text-3" id="text-8-5">
<div class="org-src-container">
<pre class="src src-rust"><span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">unstable</span><span style="color: #66cccc;">(</span><span style="color: #cc99cc;">feature = </span><span style="color: #66cccc;">"try_trait"</span><span style="color: #cc99cc;">, issue = </span><span style="color: #66cccc;">"42327"</span><span style="color: #66cccc;">)</span><span style="color: #cccccc;">]</span>
<span style="color: #cc99cc;">#</span><span style="color: #cccccc;">[</span><span style="color: #cc99cc;">derive</span><span style="color: #66cccc;">(</span><span style="color: #cc99cc;">Clone, Copy, PartialEq, PartialOrd, Eq, Ord, Debug, Hash</span><span style="color: #66cccc;">)</span><span style="color: #cccccc;">]</span>
<span style="color: #99cc99;">pub</span> <span style="color: #99cc99;">struct</span> <span style="color: #6699cc;">NoneError</span>;
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 2020-09-12 Sat 00:00</p>
<p class="author">Author: Typas Liao</p>
<p class="date">Created: 2021-02-06 Sat 22:39</p>
</div>
</body>
</html>
